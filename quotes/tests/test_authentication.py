from django.test import TestCase
from django.urls import reverse
from quotes import views
import json

class BaseTest(TestCase):
	def test_setUp(self):
		input1 = {"quoteResponse":{"result":[{"language":"en-US","region":"US","quoteType":"EQUITY","quoteSourceName":"Delayed Quote","triggerable":"true","currency":"INR","marketState":"POSTPOST","exchange":"NSI","shortName":"ADANI PORT SPECIAL","longName":"Adani Ports and Special Economic Zone Limited","messageBoardId":"finmb_27674009","exchangeTimezoneName":"Asia/Kolkata","exchangeTimezoneShortName":"IST","gmtOffSetMilliseconds":19800000,"market":"in_market","esgPopulated":"false","firstTradeDateMilliseconds":1196135100000,"priceHint":2,"regularMarketChange":2.7000122,"regularMarketChangePercent":0.8640039,"regularMarketTime":1596189597,"regularMarketPrice":315.2,"regularMarketDayHigh":318.15,"regularMarketDayRange":"312.75 - 318.15","regularMarketDayLow":312.75,"regularMarketVolume":1943658,"regularMarketPreviousClose":312.5,"bid":0.0,"ask":0.0,"bidSize":0,"askSize":0,"fullExchangeName":"NSE","financialCurrency":"INR","regularMarketOpen":315.0,"averageDailyVolume3Month":4237669,"averageDailyVolume10Day":3695011,"fiftyTwoWeekLowChange":112.20001,"fiftyTwoWeekLowChangePercent":0.5527094,"fiftyTwoWeekRange":"203.0 - 428.85","fiftyTwoWeekHighChange":-113.649994,"fiftyTwoWeekHighChangePercent":-0.26501107,"fiftyTwoWeekLow":203.0,"fiftyTwoWeekHigh":428.85,"trailingAnnualDividendRate":3.2,"trailingPE":17.180857,"trailingAnnualDividendYield":0.01024,"epsTrailingTwelveMonths":18.346,"epsForward":22.03,"sharesOutstanding":2031750016,"bookValue":125.296,"fiftyDayAverage":333.8611,"fiftyDayAverageChange":-18.661102,"fiftyDayAverageChangePercent":-0.055894807,"twoHundredDayAverage":321.37744,"twoHundredDayAverageChange":-6.177429,"twoHundredDayAverageChangePercent":-0.019221727,"marketCap":640202768384,"forwardPE":14.307762,"priceToBook":2.5156431,"sourceInterval":15,"exchangeDataDelayedBy":15,"tradeable":"false","symbol":"ADANIPORTS.NS"},{"language":"en-US","region":"US","quoteType":"EQUITY","quoteSourceName":"Delayed Quote","triggerable":"false","currency":"INR","marketState":"POSTPOST","exchange":"BSE","shortName":"ADANI PORTS AND SPECIAL ECONOM","longName":"Adani Ports and Special Economic Zone Limited","exchangeTimezoneName":"Asia/Kolkata","exchangeTimezoneShortName":"IST","gmtOffSetMilliseconds":19800000,"market":"in_market","esgPopulated":"false","firstTradeDateMilliseconds":1196135100000,"priceHint":2,"regularMarketChange":2.5500183,"regularMarketChangePercent":0.8162671,"regularMarketTime":1596189546,"regularMarketPrice":314.95,"regularMarketDayHigh":318.0,"regularMarketDayRange":"312.7 - 318.0","regularMarketDayLow":312.7,"regularMarketVolume":52600,"regularMarketPreviousClose":312.4,"bid":315.1,"ask":315.4,"bidSize":0,"askSize":0,"fullExchangeName":"BSE","financialCurrency":"INR","regularMarketOpen":313.1,"averageDailyVolume3Month":110281,"averageDailyVolume10Day":109416,"fiftyTwoWeekLowChange":111.55002,"fiftyTwoWeekLowChangePercent":0.54842687,"fiftyTwoWeekRange":"203.4 - 428.95","fiftyTwoWeekHighChange":-114.0,"fiftyTwoWeekHighChangePercent":-0.26576522,"fiftyTwoWeekLow":203.4,"fiftyTwoWeekHigh":428.95,"trailingAnnualDividendRate":3.2,"trailingPE":17.16723,"trailingAnnualDividendYield":0.010243278,"epsTrailingTwelveMonths":18.346,"sharesOutstanding":2031750016,"bookValue":125.296,"fiftyDayAverage":333.8736,"fiftyDayAverageChange":-18.923584,"fiftyDayAverageChangePercent":-0.056678887,"twoHundredDayAverage":321.38776,"twoHundredDayAverageChange":-6.437744,"twoHundredDayAverageChangePercent":-0.020031082,"marketCap":610940026880,"priceToBook":2.5136478,"sourceInterval":10,"exchangeDataDelayedBy":0,"tradeable":"false","symbol":"ADANIPORTS.BO"}],"error":"null"}}
		actual = views.logic(input1)
		diff = actual[0]['Diff']
		self.assertEqual(diff,315.1)

class BaseTest1(TestCase):
	def test_setUp2(self):
		input1 = {"quoteResponse":{"result":[{"language":"en-US","region":"US","quoteType":"EQUITY","quoteSourceName":"Delayed Quote","triggerable":"true","currency":"INR","marketState":"POSTPOST","exchange":"NSI","shortName":"ADANI PORT SPECIAL","longName":"Adani Ports and Special Economic Zone Limited","messageBoardId":"finmb_27674009","exchangeTimezoneName":"Asia/Kolkata","exchangeTimezoneShortName":"IST","gmtOffSetMilliseconds":19800000,"market":"in_market","esgPopulated":"false","firstTradeDateMilliseconds":1196135100000,"priceHint":2,"regularMarketChange":2.7000122,"regularMarketChangePercent":0.8640039,"regularMarketTime":1596189597,"regularMarketPrice":315.2,"regularMarketDayHigh":318.15,"regularMarketDayRange":"312.75 - 318.15","regularMarketDayLow":312.75,"regularMarketVolume":1943658,"regularMarketPreviousClose":312.5,"bid":0.0,"ask":0.0,"bidSize":0,"askSize":0,"fullExchangeName":"NSE","financialCurrency":"INR","regularMarketOpen":315.0,"averageDailyVolume3Month":4237669,"averageDailyVolume10Day":3695011,"fiftyTwoWeekLowChange":112.20001,"fiftyTwoWeekLowChangePercent":0.5527094,"fiftyTwoWeekRange":"203.0 - 428.85","fiftyTwoWeekHighChange":-113.649994,"fiftyTwoWeekHighChangePercent":-0.26501107,"fiftyTwoWeekLow":203.0,"fiftyTwoWeekHigh":428.85,"trailingAnnualDividendRate":3.2,"trailingPE":17.180857,"trailingAnnualDividendYield":0.01024,"epsTrailingTwelveMonths":18.346,"epsForward":22.03,"sharesOutstanding":2031750016,"bookValue":125.296,"fiftyDayAverage":333.8611,"fiftyDayAverageChange":-18.661102,"fiftyDayAverageChangePercent":-0.055894807,"twoHundredDayAverage":321.37744,"twoHundredDayAverageChange":-6.177429,"twoHundredDayAverageChangePercent":-0.019221727,"marketCap":640202768384,"forwardPE":14.307762,"priceToBook":2.5156431,"sourceInterval":15,"exchangeDataDelayedBy":15,"tradeable":"false","symbol":"ADANIPORTS.NS"},{"language":"en-US","region":"US","quoteType":"EQUITY","quoteSourceName":"Delayed Quote","triggerable":"false","currency":"INR","marketState":"POSTPOST","exchange":"BSE","shortName":"ADANI PORTS AND SPECIAL ECONOM","longName":"Adani Ports and Special Economic Zone Limited","exchangeTimezoneName":"Asia/Kolkata","exchangeTimezoneShortName":"IST","gmtOffSetMilliseconds":19800000,"market":"in_market","esgPopulated":"false","firstTradeDateMilliseconds":1196135100000,"priceHint":2,"regularMarketChange":2.5500183,"regularMarketChangePercent":0.8162671,"regularMarketTime":1596189546,"regularMarketPrice":314.95,"regularMarketDayHigh":318.0,"regularMarketDayRange":"312.7 - 318.0","regularMarketDayLow":312.7,"regularMarketVolume":52600,"regularMarketPreviousClose":312.4,"bid":315.1,"ask":315.4,"bidSize":0,"askSize":0,"fullExchangeName":"BSE","financialCurrency":"INR","regularMarketOpen":313.1,"averageDailyVolume3Month":110281,"averageDailyVolume10Day":109416,"fiftyTwoWeekLowChange":111.55002,"fiftyTwoWeekLowChangePercent":0.54842687,"fiftyTwoWeekRange":"203.4 - 428.95","fiftyTwoWeekHighChange":-114.0,"fiftyTwoWeekHighChangePercent":-0.26576522,"fiftyTwoWeekLow":203.4,"fiftyTwoWeekHigh":428.95,"trailingAnnualDividendRate":3.2,"trailingPE":17.16723,"trailingAnnualDividendYield":0.010243278,"epsTrailingTwelveMonths":18.346,"sharesOutstanding":2031750016,"bookValue":125.296,"fiftyDayAverage":333.8736,"fiftyDayAverageChange":-18.923584,"fiftyDayAverageChangePercent":-0.056678887,"twoHundredDayAverage":321.38776,"twoHundredDayAverageChange":-6.437744,"twoHundredDayAverageChangePercent":-0.020031082,"marketCap":639899664384,"priceToBook":2.5136478,"sourceInterval":10,"exchangeDataDelayedBy":0,"tradeable":"false","symbol":"ADANIPORTS.BO"},{"language":"en-US","region":"US","quoteType":"EQUITY","quoteSourceName":"Delayed Quote","triggerable":"true","currency":"INR","marketState":"POSTPOST","exchange":"NSI","shortName":"ASIAN PAINTS LTD","longName":"Asian Paints Limited","messageBoardId":"finmb_878276","exchangeTimezoneName":"Asia/Kolkata","exchangeTimezoneShortName":"IST","gmtOffSetMilliseconds":19800000,"market":"in_market","esgPopulated":"false","firstTradeDateMilliseconds":1025495100000,"priceHint":2,"regularMarketChange":-27.849976,"regularMarketChangePercent":-1.5974976,"regularMarketTime":1596189600,"regularMarketPrice":1715.5,"regularMarketDayHigh":1770.9,"regularMarketDayRange":"1710.4 - 1770.9","regularMarketDayLow":1710.4,"regularMarketVolume":1678493,"regularMarketPreviousClose":1743.35,"bid":0.0,"ask":0.0,"bidSize":0,"askSize":0,"fullExchangeName":"NSE","financialCurrency":"INR","regularMarketOpen":1754.0,"averageDailyVolume3Month":2832826,"averageDailyVolume10Day":2798153,"fiftyTwoWeekLowChange":284.30005,"fiftyTwoWeekLowChangePercent":0.19864453,"fiftyTwoWeekRange":"1431.2 - 1916.7","fiftyTwoWeekHighChange":-201.19995,"fiftyTwoWeekHighChangePercent":-0.104972064,"fiftyTwoWeekLow":1431.2,"fiftyTwoWeekHigh":1916.7,"trailingAnnualDividendRate":12.0,"trailingPE":72.5186,"trailingAnnualDividendYield":0.0068832994,"epsTrailingTwelveMonths":23.656,"epsForward":28.24,"sharesOutstanding":959198016,"bookValue":105.611,"fiftyDayAverage":1691.2014,"fiftyDayAverageChange":24.298584,"fiftyDayAverageChangePercent":0.014367647,"twoHundredDayAverage":1717.4725,"twoHundredDayAverageChange":-1.9725342,"twoHundredDayAverageChangePercent":-0.0011485099,"marketCap":1645267386368,"forwardPE":60.74717,"priceToBook":16.243572,"sourceInterval":15,"exchangeDataDelayedBy":15,"tradeable":"false","symbol":"ASIANPAINT.NS"},{"language":"en-US","region":"US","quoteType":"EQUITY","quoteSourceName":"Delayed Quote","triggerable":"false","currency":"INR","marketState":"POSTPOST","underlyingSymbol":"ASIANPAINT.BO","exchange":"BSE","shortName":"ASIAN PAINTS LTD.","longName":"Asian Paints Limited","messageBoardId":"finmb_878276","exchangeTimezoneName":"Asia/Kolkata","exchangeTimezoneShortName":"IST","gmtOffSetMilliseconds":19800000,"market":"in_market","esgPopulated":"false","firstTradeDateMilliseconds":1514864700000,"priceHint":2,"regularMarketChange":-26.449951,"regularMarketChangePercent":-1.5174087,"regularMarketTime":1596190202,"regularMarketPrice":1716.65,"regularMarketDayHigh":1770.0,"regularMarketDayRange":"1710.2 - 1770.0","regularMarketDayLow":1710.2,"regularMarketVolume":35565,"regularMarketPreviousClose":1743.1,"bid":0.0,"ask":1723.5,"bidSize":0,"askSize":0,"fullExchangeName":"BSE","financialCurrency":"INR","regularMarketOpen":1750.0,"averageDailyVolume3Month":67745,"averageDailyVolume10Day":67745,"fiftyTwoWeekLowChange":609.65,"fiftyTwoWeekLowChangePercent":0.5507227,"fiftyTwoWeekRange":"1107.0 - 1770.0","fiftyTwoWeekHighChange":-53.349976,"fiftyTwoWeekHighChangePercent":-0.030141229,"fiftyTwoWeekLow":1107.0,"fiftyTwoWeekHigh":1770.0,"trailingAnnualDividendRate":8.3,"trailingPE":81.51622,"trailingAnnualDividendYield":0.0047616316,"epsTrailingTwelveMonths":21.059,"sharesOutstanding":959817024,"bookValue":80.771,"fiftyDayAverage":1137.8,"fiftyDayAverageChange":578.85,"fiftyDayAverageChangePercent":0.5087449,"twoHundredDayAverage":1137.8,"twoHundredDayAverageChange":578.85,"twoHundredDayAverageChangePercent":0.5087449,"marketCap":1648578002944,"priceToBook":21.253296,"sourceInterval":10,"exchangeDataDelayedBy":0,"tradeable":"false","symbol":"500820.BO"}],"error":"null"}}	
		actual = views.logic(input1)
		diff = actual[1]['Diff']
		self.assertEqual(diff,0.0)
	

class BaseTest2(TestCase):
	def setUp(self):
		self.register_url=reverse('register')
		return super().setUp()

	def test_can_view_page_correctly(self):
		response=self.client.get(self.register_url)
		self.assertEqual(response.status_code,200)
		self.assertTemplateUsed(response,'register.html')

class BaseTest3(TestCase):
	def setUp(self):
		self.login_url=reverse('login')
		return super().setUp()


	def test_can_view_page_correctly(self):
		response=self.client.get(self.login_url)
		self.assertEqual(response.status_code,200)
		self.assertTemplateUsed(response,'login.html')

